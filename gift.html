<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>特色礼品</title>
    <link rel="stylesheet" href="./css/pgy-css/bootStarp.css">
    <link rel="stylesheet" href="./css/pgy-css/swiper.min.css">
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="./css/pgy-css/reset.css">
    <link rel="stylesheet" href="./css/pgy-css/gift.css">
    <link rel="stylesheet" href="https://www.layuicdn.com/layui-v2.5.5/css/layui.css">
</head>

<body>
    <!-- 整体页面 整个 -->
    <div class="gift">
        <!-- 头部 -->
        <header>
            <div class="header-top">
                <div class="wrap">
                    <div class="header-top-left">
                        <span><a href="javascript:;">收藏鲜花网(hua.com)</a></span>
                        <span><a href="javascript:;">关注微信</a></span>
                        <span><a href="javascript:;">花礼网app</a></span>
                    </div>
                    <div class="header-top-right">
                        <ul>
                            <li><a href="javascript:;">你好，请登录<li>注册</li></a></li>
                            <li><a href="javascript:;">订单查询</a></li>
                            <li><a href="javascript:;">我的花礼</a></li>
                            <li><a href="javascript:;">客户服务</a></li>
                            <li class="buy-car">
                                <a href="javascript:;">购物车</a>
                                <div class="pos"></div>
                            </li>
                            <li>特色礼品-生日礼物</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="search wrap">
                <div class="title1">
                    <h1>花礼网</h1>
                </div>
                <div class="ipt">
                    <input type="text" color="#999" placeholder='商品关键词'>
                    <span>搜索</span>
                </div>
                <div>
                    <span>400-889-8188</span>
                    <span class="top001">|</span>
                    <a href="javascript:;">在线客服</a>
                </div>
            </div>
            <div class="top-nav">
                <div class="wrap">
                    <ul>
                        <li><a href="javascript:;">全部商品导购</a></li>
                        <li>
                            <a href="./index.html">
                                首页
                            </a>
                        </li>
                        <li>
                            <a href="./flower.html">
                                鲜花
                            </a>
                        </li>
                        <li>
                            <a href="./immortal.html">
                                永生花
                            </a>
                        </li>
                        <li>
                            <a href="./cake.html">
                                蛋糕
                            </a>
                        </li>
                        <li>
                            <a href="./gift.html">
                                礼品
                            </a>
                        </li>
                        <li>
                            <a href="./chocolate.html">
                                巧克力
                            </a>
                        </li>
                        <li>
                            <a href="./flower-language.html">
                                花语大全
                            </a>
                        </li>
                        <li>
                            <a href="./group.html">
                                企业团购
                            </a>
                        </li>
                        <li>
                            <a href="./design.html">
                                设计师臻选鲜花
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </header>
        <!-- 轮播 -->
        <div class="swiper-container wrap">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <a href="javascript:;"><img src="./img/pgyimg/banner1.jpg" alt=""></a>
                </div>
                <div class="swiper-slide">
                    <a href="javascript:;"><img src="./img/pgyimg/banner2.jpg" alt=""></a>
                </div>
            </div>
            <div class="swiper-pagination"></div>
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
        </div>
        <!-- 新品 上市-->
        <div class="new wrap">
            <div class="newProduct">
                <div>
                    <p>新品上新<span>new</span></p>
                    <hr>
                    <h3>又有美美的礼品上新啦！</h3>
                </div>
            </div>
            <div class="sale">
                <div>
                    <p>施华洛世奇<span>sale</span></p>
                    <hr>
                    <h3>国际品质 大牌保证 </h3>
                </div>
            </div>
            <div class="cute">
                <div>
                    <p>Hello Kitty<span>cute</span></p>
                    <hr>
                    <h3>没有比这里更萌的啦！</h3>
                </div>
            </div>
        </div>
        <!-- tab切换 全部分类-->
        <div class="tab1 wrap">
            <ul id="tab" onclick="getTab()">
            </ul>
        </div>
        <!-- tab2 -->
        <div class="tab2 wrap">
            <span>人群：</span>
            <span>送恋人妻子</span>
            <span>送男性</span>
            <span>送朋友同事</span>
            <span>送客户</span>
            <span>送老师</span>
            <span>送小孩</span>
            <span>送领导礼物</span>
            <span>送父母长辈</span>

        </div>
        <!-- tab3 -->
        <div class="tab3 wrap">
            <span>排序:</span>
            <ul>
                <li><a href="javascript:;">综合</a></li>
                <li><a href="javascript:;">销量</a></li>
                <li><a href="javascript:;">最新</a></li>
                <li><a href="javascript:;">价格</a></li>
                <li>
                    <a href="javascript:;">
                        <input type="text" class="int1" value="￥"> &nbsp &nbsp _ &nbsp &nbsp
                        <input type="text" class="int2" value="￥">
                    </a>
                </li>
            </ul>
        </div>
        <!-- 数据渲染 -->
        <div class="render wrap">
            <!-- //主体数据 -->
            <ul id="lists"></ul>
            <!-- 分页 -->
            <hr>
            <!-- <ul id="page" onclick="getPage(id)">

            </ul> -->
            <nav>
                <ul class="pagination" id="page" onclick="getPage(id)">
                    <li class="disabled"><a href="javascript:;" aria-label="Previous"><span aria-hidden="true">上一页</span></a></li>
                    <li id="last"><a href="javascript:;" aria-label="Next"><span aria-hidden="true">下一页</span></a></li>
                </ul>
            </nav>
            <hr>
        </div>
    </div>
    <!-- 数据渲染结束 -->
    <!-- 底部 -->
    <div class="fool wrap">
        <div class="fool1">
            <p>特色礼品&送礼常识</p>
            <div>
                <ul>
                    <li><a href="javascript:;">毕业礼物送什么好？</a></li>
                    <li><a href="javascript:;">毕业了送同学什么最有纪念意义？</a></li>
                    <li><a href="javascript:;">送同学什么生日礼物好？</a></li>
                    <li><a href="javascript:;">特色礼物有哪些？</a></li>
                    <li><a href="javascript:;">送女孩子什么礼物好？泰国保鲜花推荐</a></li>
                </ul>
                <ul>
                    <li><a href="javascript:;">送国内爱人什么生日礼物好？</a></li>
                    <li><a href="javascript:;">送老婆什么生日礼物好？</a></li>
                    <li><a href="javascript:;">老婆生日送什么礼物好?</a></li>
                    <li><a href="javascript:;">结婚礼物推荐，结婚送什么礼物最好？</a></li>
                    <li><a href="javascript:;">情人节礼物送什么？</a></li>
                </ul>
                <ul>
                    <li><a href="javascript:;">不宜在公开场合赠送的礼物</a></li>
                    <li><a href="javascript:;"> 如何给同辈者送的生日礼物？</a></li>
                    <li><a href="javascript:;">懒人的节日礼物应急方案</a></li>
                    <li><a href="javascript:;">结婚礼品推荐</a></li>
                    <li><a href="javascript:;">赠送礼品小常识</a></li>
                </ul>
            </div>
        </div>
        <div class="fool2">
            <a href="javascript:;">首页</a>
            <span>|</span>
            <a href="javascript:;">关于我们</a>
            <span>|</span>
            <a href="javascript:;">媒体报道</a>
            <span>|</span>
            <a href="javascript:;">联系方式</a>
            <span>|</span>
            <a href="javascript:;">企业团购</a>
            <span>|</span>
            <a href="javascript:;">花店入驻</a>
            <span>|</span>
            <a href="javascript:;">友情链接</a>
            <span>|</span>
            <a href="javascript:;">在线补款</a>
            <span>|</span>
            <a href="javascript:;">为什么选择中国鲜花礼品网</a>
        </div>
        <div class="fool3">
            <div class="imgs">
                <img src="./img/pgyimg/fool1.png" height="50" width="212">
                <img src="./img/pgyimg/fool2.png" height="49" width="150">
                <img src="./img/pgyimg/fool3.png" alt="ICP" height="46" width="35">
                <img src="./img/pgyimg/fool4.png" title="深圳市市场监督管理局企业主体身份公示" alt="深圳市市场监督管理局企业主体身份公示" width="35" height="49" border="0" style="border-width:0px;border:hidden; border:none;">
            </div>
            <p>中国花卉协会会员 中国电子商务协会会员 ICP经营许可证：粤B2-20050744 | 粤ICP备09171662号 粤公网安备44030502000373号 Copyright © 2005-2020</p>
            <p>花礼网 （中国鲜花礼品网） www.hua.com 深圳市百易信息技术有限公司 特色礼品、创意礼物专区！</p>
        </div>
    </div>
    <script src="./index.js"></script>

    <script src="./js/pgy-js/gift.js"></script>
    <script src="./js/pgy-js/swiper.min.js"></script>
    <script src="./js/pgy-js/axios.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/layui/2.5.7/layui.all.js"></script>
    <script>
        var lists = document.getElementById('lists');
        var tab = document.getElementById('tab');
        var page = document.getElementById('page');


        //渲染数据
        //tab切换   ????? li上的data-id没效果 
        axios.get("http://localhost:3000/tab").then(res => {
            var str1 = '';
            for (var i = 0; i < res.data.data.length; i++) {
                str1 += `
                    <li>
                        <a href="javascript:;" data-id="${res.data.data[i].id}">
                            <div class="back" data-id="${res.data.data[i].id}"></div>
                            <p data-id="${res.data.data[i].id}">${res.data.data[i].title}</p>
                        </a>
                    </li>
               `

            }
            tab.innerHTML = str1;
            //高亮tab切换的
            var tabList = document.querySelectorAll('#tab li')
                // console.log(12313213131,tabList); 
            tabList[0].classList.add('active')
            tabList.forEach(item => {
                    item.onclick = function() {
                        for (var i = 0; i < tabList.length; i++) {
                            tabList[i].classList.remove('active')
                        }
                        this.classList.add('active')
                    }
                })
                //高亮结束
        }).catch(err => {
            console.log(err);
        })



        //tab点击事件  
        function getTab() {
            //i就是点击是对应的大分类id 就是type_id
            i = event.target.dataset.id
            lists1(i)
            length1(i)
            localStorage.setItem('tabId', i)
        }



        //获取大分类下的数据长度  动态渲染页数
        function length1(id = 0) {
            var last = document.getElementById('last')
                //清空页数
            var test = document.querySelectorAll('.test')
            console.log(33333, test);
            // test.forEach(item=>{
            //     console.log(7777,item);
            //     item.classList.add('pageActive')
            // })
            if (test.length) {
                for (var i = 0; i < test.length; i++) {
                    page.removeChild(test[i])
                }
            }

            axios.get('http://localhost:3000/length', {
                params: {
                    type_id: id
                }
            }).then(res => {
                //    console.log(111,res.data.data);
                var num = Math.ceil(res.data.data.length / 28)
                console.log(23333, num)
                    //    var str1 =''
                    //    for(var i=1;i<=num;i++){
                    //       str1 += `<li>${i}</li>`
                    //    }
                    //    page.innerHTML = str1
                var str = ""
                for (var i = 0; i < num; i++) {
                    str += ` 
                     <li class="test">${i+1}</li>
                     `
                }

                // 将字符串转化为dom节点
                var str1 = new DOMParser().parseFromString(str, 'text/html').body.childNodes
                console.log(121121212, str1)
                for (var i = 0; i < str1.length; i++) {
                    page.insertBefore(str1[i], last)
                }

            }).catch(err => {
                console.log(err);
            })
        }
        length1()


        //分页
        function getPage() {
            //调用主体数据 两个参数 id大分类 page分页的页数
            //先判断在哪个大分类里 在执行分页点击事件
            //刚进来没有任何点击事件 需要判断默认大分类是 全部id是0
            //告诉后台 没点一次页数 就要判断一下在哪个大分类下 点一次执行一次否则后台不知道点的是对应的哪个大分类
            length1(localStorage.getItem('tabId'))
            lists1(localStorage.getItem('tabId'), event.target.innerHTML)
        }

        //tab 结束
        //跳转详情
        function jump(i) {
            localStorage.setItem("jump-id", i)
            window.location.href = 'detail.html'
                // window.open = 'detail.html'
        }


        //主体数据 封装函数
        //数据库中type_id  type-id不对 下划线的写法才对
        function lists1(id = 0, page = 1) {
            axios.get("http://localhost:3000/home", {
                params: {
                    id,
                    page
                }
            }).then(res => {
                var str = ''
                console.log(res);
                for (var i = 0; i < res.data.data.length; i++) {
                    str += `
                     <li onclick="jump(${res.data.data[i].id})"><a href="javascript:;">
                        <img src="${res.data.data[i].url}" alt="图片丢失">
                        <div class="box">
                            <p>${res.data.data[i].lable}</p>
                            <h2>${res.data.data[i].title}</h2>
                            <span class="price">${res.data.data[i].price}</span>
                            <hr>
                            <span class="desc">${res.data.data[i].desc}</span>
                        </div>
                    </a></li>
                `
                }
                lists.innerHTML = str
            }).catch(err => {
                console.log(err);
            })
        }
        //上来先存一下 没有任何事件的时候 全部的数据点击才能显示
        window.onload = function() {
            lists1();
            localStorage.setItem('tabId', 0)
        }



        //轮播
        var swiper = new Swiper('.swiper-container', {
            slidesPerView: 1,
            spaceBetween: 30,
            loop: true,
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            autoplay: {
                delay: 2500,
                disableOnInteraction: false,
            }
        });
    </script>
</body>

</html>